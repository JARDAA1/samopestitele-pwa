<!DOCTYPE html>
<html>
<head>
    <title>Force Logout</title>
    <meta charset="utf-8">
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f44336;
            color: white;
        }
        .card {
            background: white;
            color: #333;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
        }
        h1 {
            margin-top: 0;
            color: #f44336;
        }
        button {
            background: #f44336;
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
        }
        button:hover {
            background: #da190b;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 6px;
            background: #e8f5e9;
            color: #2e7d32;
        }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="card">
        <h1>üö® FORCE LOGOUT</h1>
        <p><strong>Tento n√°stroj OKAM≈ΩITƒö vyma≈æe v≈°echna p≈ôihla≈°ovac√≠ data a odhl√°s√≠ v√°s z aplikace.</strong></p>

        <button onclick="forceLogout()">üóëÔ∏è VYNUTIT ODHL√Å≈†EN√ç</button>

        <button onclick="showStatus()" style="background: #4CAF50;">üìä Zobrazit souƒçasn√Ω stav</button>

        <div id="result"></div>
    </div>

    <script>
        function showStatus() {
            const keys = [
                'farmar_session',
                'auth_level',
                'farmar_pin',
                'farmar_data',
                'zakaznik_id',
                'pestitelLoggedIn',
                'pestitelId',
                'pestitelTelefon'
            ];

            const data = {};
            let totalKeys = 0;

            // Check localStorage
            keys.forEach(key => {
                const value = localStorage.getItem(key);
                if (value !== null) {
                    totalKeys++;
                    try {
                        data[key] = JSON.parse(value);
                    } catch (e) {
                        data[key] = value;
                    }
                }
            });

            // Check for Supabase keys
            const allKeys = Object.keys(localStorage);
            const supabaseKeys = allKeys.filter(k => k.includes('supabase'));

            const result = document.getElementById('result');
            result.className = 'result';
            result.innerHTML = `
                <h3>üìä Souƒçasn√Ω stav:</h3>
                <p><strong>Farmer keys:</strong> ${totalKeys} kl√≠ƒç≈Ø</p>
                <p><strong>Supabase keys:</strong> ${supabaseKeys.length} kl√≠ƒç≈Ø</p>
                <h4>Obsah localStorage:</h4>
                <pre>${JSON.stringify(data, null, 2)}</pre>
                ${supabaseKeys.length > 0 ? `<h4>Supabase keys:</h4><pre>${supabaseKeys.join('\n')}</pre>` : ''}
            `;
        }

        function forceLogout() {
            const result = document.getElementById('result');

            // Step 1: Remove farmer keys
            console.log('üóëÔ∏è Removing farmer keys...');
            const farmerKeys = [
                'farmar_session',
                'auth_level',
                'farmar_pin',
                'farmar_data',
                'zakaznik_id',
                'pestitelLoggedIn',
                'pestitelId',
                'pestitelTelefon'
            ];

            let removedCount = 0;
            farmerKeys.forEach(key => {
                if (localStorage.getItem(key) !== null) {
                    localStorage.removeItem(key);
                    removedCount++;
                    console.log(`  ‚úì Removed: ${key}`);
                }
            });

            // Step 2: Remove all Supabase keys
            console.log('üóëÔ∏è Removing Supabase keys...');
            const allKeys = Object.keys(localStorage);
            const supabaseKeys = allKeys.filter(k => k.includes('supabase'));

            supabaseKeys.forEach(key => {
                localStorage.removeItem(key);
                removedCount++;
                console.log(`  ‚úì Removed: ${key}`);
            });

            result.className = 'result';
            result.innerHTML = `
                <h3>‚úÖ ODHL√Å≈†EN√ç DOKONƒåENO!</h3>
                <p>Vymaz√°no: <strong>${removedCount} kl√≠ƒç≈Ø</strong></p>
                <p>localStorage je nyn√≠ pr√°zdn√Ω.</p>
                <hr>
                <p><strong>Nyn√≠:</strong></p>
                <ol>
                    <li>Zav≈ôete tuto str√°nku</li>
                    <li>Jdƒõte do aplikace</li>
                    <li>Obnovte str√°nku (F5 nebo Cmd+R)</li>
                    <li>Mƒõli byste b√Ωt odhl√°≈°eni</li>
                </ol>
            `;

            console.log(`‚úÖ Force logout complete - removed ${removedCount} keys`);
        }

        // Show status on load
        window.addEventListener('load', showStatus);
    </script>
</body>
</html>
